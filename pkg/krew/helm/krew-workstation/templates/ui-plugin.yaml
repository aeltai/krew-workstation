{{- if .Values.uiPlugin.enabled }}
apiVersion: catalog.cattle.io/v1
kind: UIPlugin
metadata:
  name: {{ include "krew-workstation.fullname" . }}
  namespace: {{ .Values.uiPlugin.namespace | default .Release.Namespace }}
  labels:
    {{- include "krew-workstation.labels" . | nindent 4 }}
spec:
  plugin:
    # Must match extension plugin/package.json "name" so Rancher registers the sidebar entry
    name: {{ .Values.uiPlugin.pluginName | default "krew" }}
    version: {{ .Values.uiPlugin.version | default .Chart.AppVersion | quote }}
    endpoint: {{ .Values.uiPlugin.endpoint | quote }}
    noCache: {{ .Values.uiPlugin.noCache }}
    noAuth: {{ .Values.uiPlugin.noAuth }}
    metadata:
      {{- with .Values.uiPlugin.metadata }}
      {{- toYaml . | nindent 6 }}
      {{- end }}
{{- end }}
